# SEMAGE:一种新的基于图像的双因子验证码

## 摘要
我们提出了SEMAGE（**Se**mantically **Ma**tching
Ima**ge**s），一种基于图片的验证码，它利用人的能力去定义理解图片的内容和建立他们之间的*语义关系*。一个SEMAGE问题需要用户从给定的图片集中选择*语义关联*图片。SEMAGE有双因子设计，用户需要指出每个图片的内容然后理解和指出拥有语义联系的子集合。大多数的基于图片状态的图片系统像Assira[20]，只需要用户去解决第一个层次：图像识别。利用图像语义关联创建更加安全和用户友好的问题让SEMAGE新奇。SEMAGE并不会有像传统的基于图片的方法有的取法定制性和适配性的缺点。SEMAGE不像现在的基于文本的系统，它是很用户友好的很有乐趣的。这些特性让它对web服务提供者是十分有吸引力的。另外，SEMAGE是依赖语言的和对定制高度灵活的（在安全性和可用性层次）。SEMAGE还是移动设备友好的，因为它不需要用户输入任何东西。我们实施第一个这种类型的大伸展性的174个用户的研究来计量比较SEMAGE，reCAPTCHA（test-base）和Asirra（image-based）的精度和可用性。用户研究进一步验证我们的观点，结果表明用户使用我们的系统拥有更高得精度，并认为我们的系统是有乐趣的和简单的。

## 类别和主题描述
K.6.5[计算机空间]：计算机管理和信息系统 - 安全和保护

## 主要词汇
安全

## 关键字
验证码，基于语义的交互验证，双因子验证码

## 1. 前言
在生活的各个领域，每天都有新的web应用和服务出现。许多人都适应了在线服务，如email服务，论坛和专业兴趣组。对于服务提供者，一个重要方面是考虑怎样确保服务和资源能被目标客户使用。恶意使用服务，如使用机器人去注册合法账户[9]，不仅会占用宝贵资源，还未发布恶意信息埋下伏笔。所以服务提供商能从人类的访问中分辨出机器人是十分重要的，为了这个目的，验证码系统被广泛使用。
验证码（CAPTCHA）是“Completely Automated Public Tests to tell Computers and Humans Apart”[29,28,27,15,9]的缩写。主要思想是出一道困难的AI问题来区别当前服务的是机器人还是合法用户，除非AI技术获得突破性进展。验证码系统的鲁棒性并非依赖数据库的安全性，而是这个问题固有的难度。解决验证码问题的难度对于人和机器人来说，通常有相同的难度。因为验证码系统很少是独立的，它一般是应用程序的一部分，如在线注册，让用户花多于几秒钟的时间去解决验证码问题是不现实的。于是，在现实系统中，一个复杂的问题需要人花费很长时间去解决是不现实的。
辨识扭曲的文字，基于图片的提问，是一种防止机器人的技术，使用非常广泛。然而，伴随着计算机视觉领域的发展，机器人已经可以破解使用如OCR（Optical
Character Recognition）和语义[30, 26, 16, 2, 19]技术的文本验证码。引入噪声和扭曲来提高基于文本的系统复杂度虽然让机器人的破解变得困难，但是同样也降低了用户友好性和可用性。
基于图片的系统目的是提高验证码系统的可用性[20, 3, 17, 23, 18, 7, 25, 32]。然而，许多现有的基于图像状态的图片系统如Asirra[20]有着灵活性和适应性不良的缺点。Asirra是难度只有图像识别，需要用户来找出所有的猫从猫和狗中。在像Asirra系统上，如Golle所示[22]，一种特别的机器学习技术的攻击方法已经获得很高的识别率。此外，呈现给机器人的固有选择总是二值（一个图片是猫或是狗），让它对模板适应攻击很敏感，这个问题将在4.2章中详细讨论。我们提出了SEMAGE，一种新奇的基于图像的验证码系统，它有双因子模型需要用户来识别图片和确定图片所共有的语义上的联系。语义上联系使得SEMAGE有更好的鲁棒性来面对相同的机器学习攻击。其他的基于图像的系统，像ESP_PIX[3]和 SQ_PIX[7]有语言依赖和可使用性的担忧。我们将说明更多的验证码系统和它们的局限性在2章中。
在本论文中，我们提出了SEMAGE（**Se**mantically **Ma**tching
Ima**ge**s），一种双因子验证码系统。在SEMAGE系统中，我们把一系列的候选图片呈现给用户，而不呈现拥有语义联系的子集合。对于用户的挑战是在内容中确定系统定义的语义相关的图片。需要注意的事，在正确集合里的图片不需要拥有相同的对象，一个语义相关的图片集合可能是不同物理属性单却有相同的定义内容的实体的图片组成的。考虑这样一个例子，用户需要回答内容相似拥有相同起源的图片，候选集包括图片如木柴，木椅，火柴，电器，一个动物和一个人，木柴，木椅，火柴属于一个相似集。
SEMAGE验证码系统难度体现在两个方面：（1）用户需要独立的指出每张图片的内容，也就是图像识别，（2）还需要在理解图像的语义关系的基础上正确的匹配文件。人类会很自然的采用他们的认知能力和平常直觉来解决这个问题，甚至不会感觉到这个问题固有的难度。同样，机器人也要面对相同的难度，即理解图片并指出它们之间的关系，这构成了一个很难的AI问题。我们的双因子设计主要目的是提高机器人破解的难度等级的同时提高用户友好性，而不牺牲系统的鲁棒性。
SEMAGE的新奇之处是呈现给用户双因子问题：“在给定的内容中确定相同语义的图片”。展示语义相似的图片让用户选择的点子比简单的选择相同物种的动物图片更加宽广（Assira中的例子是猫）。这个特性让SEMAGE与基于图像状态的图片不同，它仅仅需要用户解决第一个层次的问题：图像识别。计算机很难去理解并确定图片内容的语义，这使得SEMAGE对于机器人有很好的鲁棒性。我们将陈述和讨论一些相似语义的需要在3章。
我们也实现了一个非常简单的SEMAGE例子，使用真实的和卡通的动物图片。用户需要挑出相同物种的图片（真实的或是卡通的）。这种特别的实现会有明显的好处：（1）因为用户可以很容易的在真实和卡通图片之间建立连接，所以没有给用户增加负担，却增加了用户的乐趣；（2）因为机器人卡通图片可能没有真实的物理上的动物的属性，从而增加机器人破解的难度等级。除此之外，SEMAGE提供了一个容易操作的接口来指示正确的答案，这使得它对输入比较困难的设备如基于触控的系统和小的手机来说是理想的选择。图片1是一个简单的简化了的SEMAGE。人们可以确定图片的标签，而机器人却很难找出真实和卡通图片之间的联系，因为形状和纹理是不同的。需要注意的是，这里只是一种SEMAGE的实现。其他任何的*语义关系*都可以被用来当实体，来替代我们的简化的实现。
这篇论文的主要贡献如下：

- 我们提出了SEMAGE，一种基于图片的双因子验证码，它有价格独一无二的特性。SEMAGE的设计使用简单的办法提升了自然的和受欢迎的网站的安全性和可用性。SEMAGE验证码图片可以变化，使其适应不同需求的网站。事实上，给图片标示上*语义联系*是很简单，可以根据直觉完成的事。我们提供了深层次的安全分析来展示SEMAGE对于许多攻击有更好的鲁棒性比起现有的系统。
- 我们更进一步的使用简单的简化的SEMAGE实现，实施了一个大尺度的用户研究，174个用户参加了这个研究。我们系统与基于文本的验证码系统reCAPTCHA[6]和基于图像的Asirra[20]在可用性和娱乐性上进行对比。正如5章节讨论的一样，结果显示我们的系统更加容易去使用，参与者对我们系统的娱乐性给出了很高的评价

## 2.背景
CAPTCHA系统，特指基于文本的，作为反机器人首选方案，已经被广泛的使用在互联网中。最近，随着计算机视觉技术的提高，基于文本的系统变得对于机器人的攻击易感，攻击拥有很高的成功几率[30,26,16,2,19,13]。因此，很多精力花在了如何替换CAPTCHA系统，如基于图片的[20,3,17,23,18,7,25,32]和基于声音的[14,10,1,21]系统。

### 2.1 基于文本的系统
大体来说，基于文本的验证码系统让用户辨识字母或者数字。GIMPY是一种经典的例子[4]，攻击基于文本的系统大多使用OCR(optical character recognition)算法。这个算法首先把图片分割成小的区块，每个区块只有一个字母，然后使用模式识别算法去匹配每一个区块和字母模板的特性[30,26,16]。这里的后一步是一个很成熟的AI问题。为了防止这样的攻击，基于文本的系统使用了如下的技术来加强鲁棒性[15,19]：

- 添加一些噪音，如一些散落的横线和点，到背景中来干扰区域分割算法。
- 字符被连接起来，或者互相重叠起来，来让攻击算法无法正确的划分图片到正确的区块里。
- 字符是扭曲的来增加文字识别的难度。

然而，以上的技术提高了人类识别的难度。字符的连接让人类也很难识别。举个例子，让字符‘r’和‘n’被连接起来，就像是字符‘m’。扭曲的字符不仅折磨用户的神经，还会影响准确率。图2展示了一个很难去解决的基于文本的问题。
基于文本的系统面对一个必然的处境：当验证码系统变得复杂后，人们会解决觉得验证码很难受的。这可能是一些热门的网站如MSN邮件使用简单的干净的的验证码，但是破解的准确率高于80%[30]。一些系统使用特别的颜色来标示每个字符，再给背景添加非字符颜色。然而这些都能很容易被自动化的程序移除，并没有个机器人添加任何的困难[31]。
热门的系统，如‘reCAPTCHA’[6]使用词典单词，这些单词是被真实的自动化OCR程序标示为无法识别的，这个过程也被来数字化图书和验证其他用户数据如的正确性。然而，reCAPTCHA同样也减少了用户友好性和用户满意度，因为一些高度扭曲和噪音。

### 2.2 基于声音的系统
基于声音的验证码系统[1,14,10,21]补偿了可视化验证码系统无法满足视觉障碍的人的可用性需求。在一个典型的基于声音的系统里，字母和数字被随机的时间间隔隔开来以发音的方式呈现出来。为了使它对机器人更加有鲁棒性，背景噪音被添加到音频文件中。这样的系统很大的依赖声音硬件，并且用户只有很少的时间去确定每一个字符。一些人认为，声音验证码系统仅仅是基于文本的系统的听觉版本。虽然可视化的东西呗声音代替，但是构成攻击的基础都是相似的 - 特征提取和分类字母。对于机器人和人类的难度曲线是相似的[12]。所以声音验证码系统既没有提供更加用户友好的接口对于视觉访问用户，也没对机器人有更好的鲁棒性[11]。

### 2.3 基于图像的系统
基于图像的系统的出现时为了替代对于人来说越来越复杂的基于文本的验证码系统，基于图像的系统人类更好去解决。设计一个好的验证码系统，安全性不仅仅是考虑因素。所有的验证码系统都是HIP（Human Interactional Proofs）的一种形式，需要用户加入。所以用户友好性在设计中是一个很重要的因素。Tygar[17]提出了一个好的验证码系统有如下需求：

- 对于人类来说，任务应该是很简单的
- 对于计算机算法来说，任务应该是很难得
- 数据库应该能很简单的被实现和分析。

基于图片的验证码主要利用图片比起文本有更多信息。对于人类来说依靠直觉能很好抓住图片的额特征而对于AI算法来说，却是很难得。ESP-PIX[3]是呈现给用户一系列的图片，然后需要用户从一些类词语中选择一个能描述所有图片的。这中方法有两种缺点：它还是依赖文本去表达含义，因为所有的单词都是英文，用户验证成功很大程度上依赖他对英语的熟练程度（或者它移植到的其他语言）。它不仅仅依赖语言，还很难去实施。用户需要大致浏览所有的给出的单词，然后找到一个最可能的单词。SQ-PIX[7]也给用户一系列图片，但是让用户选择一张定出物品名字对应的图片，并标示出物品所在位置。这同样也是依赖于语言的而且在指定图片的时候需要一个手持设备如鼠标来操作，并不能对所有用户都简单。
Google的图片验证码‘what's up’[23]需要用户去调整图片的方向。这样的系统是语言无关的，但是调整的过程需要很多的精力和微小的鼠标（或者其他硬件）移动。还有一些图片可能有些模棱两可因为它有多个正确的方向。
Microsoft的Asirra[20]利用了在petfinder.com上的已有的数据库，呈现给用户许多猫和狗的照片，然后让用户在12个宠物中确定所有猫的图片。这个平台是语言无关的，需要用户查看12张图片，然后平均点击6次。图3显示Assira的一个简单例子。
Asirra配合petfinder.com可以访问他的很大的有猫和狗的数据库。但是固有的难度对于机器人来说仅仅是区分猫和狗。这使得Assira是不稳固面对机器学习攻击[22]。而SEMAGE在有双因子设计，用户需要识别每张图片，还需要理解并确定它的子集语义上的联系。而Assira只需要用户去解决第一个层次（图像识别）。利用图片之间的语义相关性，制造更加安全和用户友好的测试让SEMAGE有更好的鲁棒性。

## SEMAGE设计
我们提出了SEMAGE，“**Se**mantically **Ma**tching
Ima**ge**s”，一种新奇的基于图片的双营子验证码系统，他利用图片之间的语义关系。语义上的查询已经被用在其他领域如web搜索[24]。我们构想定义语义相似的图片然后设计一个利用这样概念用户友好的和有更好鲁棒性的验证码系统。

### 3.1 直觉思想
所有的基于图片的验证码系统有两个组件：一个图片数据库和一个怎样去使用数据库创建问题的‘概念’。固有的概念和PIX[8]一样简单，就是从数据库中抽取一系列有相同物体的图片展示出来，然后让用户指定合适的图片标签或者更复杂的东西像Cortcha[32]。Cortcha使用书库创建一个待修复的图片和一些候选图片，然后让用户把正确的图片放置到待修复的图片中。
SEMAGE背后的思想是使用图片之间的语义上的关联，让用户选出语义相关或是相似的图片。语义关系是相似图片背后的真实的描述。语义关系的选择对于一个应用来说有很大的自由度，数据库给了很大可定制的灵活性。举个例子，对于一个电子商务网站，SEMAGE可以以产品图片形式显示出来（ipod，zune，电视，燃气热水器，冰箱等等），让用户选择能干相同事的东西（在这个例子中是ipod和zune，都是音乐播放器）。
SEMAGE呈现一系列的候选图片，这些候选图片的子集有相同的隐含的连接或是关系。对于用户的问题是正确的确定所有图片的语义上的关联。
### 3.2 定义语义关系
我们现在陈述选择‘语义相似’关系的图片来创建验证码问题。‘语义标签’是一个专业词汇表述一个对象的有关系的标签。语义标签可以被直接的使用来标示数据库创建问题。让$$SL(x)$$标示返回x的语义标签的函数，我们认为两张图片是语义相关的，如果他满足下面的任意一种情况

- 情况1：如果两张图片拥有相同的语义标签。给出两张图片A和B，他们如果$$SL(a)=SL(b)$$，则认为他们有语义上的联系。例如，一个电脑的图片和一个电视的图片被定义一样的语义标签($$SL$$)‘电器’
- 情况2：两张图片被分类到相同类别的语义标签。给出两个图片A和B，他们有语义上的联系如果$$ T s.t. SL(A)T & SL(B)T$$，其中$$T$$代表一个语义标签。举个例子，一个狮子的图片和一个鹿的图片可以被分到相同的语义标签下‘四条腿的动物’。相似的，一个电视的图片和一个电脑的图片可以被分到相同的语义标签‘电器’。
- 情况3：当两张图片放到一起的时候，他们展示了独一无二的可辨识的概念。给出两张图片A，B和一些语义标签C，其中C代表需求的集合，A和B是语义上合适的如果$${A B =C}$$其中$$=$$标示左边的满足右边的需求，举个例子，一张打印机的图片和一张纸的图片也可以被定义为可以辨识的概念‘打印’，这是一个语义标签。

‘语义关系’的需求更加普遍，语义相关增加，因为我们可以将情况1移动到情况3.为了建立一个SEMAGE问题，我们应该确保只有一个图片的子集可以满足上面的情况，最好给图片最少的广义标签。

